(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const n of s.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&r(n)}).observe(document,{childList:!0,subtree:!0});function i(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?s.credentials="include":e.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(e){if(e.ep)return;e.ep=!0;const s=i(e);fetch(e.href,s)}})();class o{state;subscribers=new Set;animationFrameId=null;syncWithDocumentTimeline=!1;constructor(t){this.state={...t,currentFrame:0,isPlaying:!1}}setState(t){this.state={...this.state,...t},this.notifySubscribers()}getState(){return this.state}subscribe(t){return this.subscribers.add(t),t(this.state),()=>this.unsubscribe(t)}unsubscribe(t){this.subscribers.delete(t)}notifySubscribers(){for(const t of this.subscribers)t(this.state)}play(){this.state.isPlaying||(this.setState({isPlaying:!0}),this.animationFrameId=requestAnimationFrame(this.tick))}pause(){this.state.isPlaying&&(this.setState({isPlaying:!1}),this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null))}seek(t){const i=Math.max(0,Math.min(t,this.state.duration*this.state.fps));this.setState({currentFrame:i}),typeof document<"u"&&document.timeline&&i/this.state.fps*1e3}bindToDocumentTimeline(){if(typeof document>"u"||!document.timeline){console.warn("document.timeline is not available.");return}this.syncWithDocumentTimeline=!0;const t=()=>{if(!this.syncWithDocumentTimeline)return;const i=document.timeline.currentTime;if(i!==null&&typeof i=="number"){const r=Math.round(i/1e3*this.state.fps);r!==this.state.currentFrame&&this.setState({currentFrame:r})}requestAnimationFrame(t)};requestAnimationFrame(t)}unbindFromDocumentTimeline(){this.syncWithDocumentTimeline=!1}tick=()=>{if(!this.state.isPlaying)return;if(this.syncWithDocumentTimeline){this.animationFrameId=requestAnimationFrame(this.tick);return}const t=this.state.duration*this.state.fps,i=this.state.currentFrame+1;if(i>=t){this.setState({currentFrame:t-1}),this.pause();return}this.setState({currentFrame:i}),this.animationFrameId=requestAnimationFrame(this.tick)}}export{o as H};
